<div class="mt-3" style="margin-left: 20px">
  <h2>{{formName}} Employee</h2>
</div>
<form [formGroup]="employeeForm" class="p-4" (ngSubmit)="submit()">
  <div class="row">

    <!-- First Name -->
    <div class="col-4 mb-3">
      <label for="firstName" class="form-label">First Name<span style="color: red;">*</span></label>
      <input formControlName="firstName" id="firstName" class="form-control" placeholder="Enter First Name"
        tabindex="-1" maxlength="50"
        [ngClass]="{ 'is-invalid':employeeForm.get('firstName')?.touched && employeeForm.get('firstName')?.invalid }" />
        <!-- <small *ngIf="employeeForm.get('firstName')?.invalid && 
        (employeeForm.get('firstName')?.touched)"> -->
  
          <!-- Maxlength Validation -->
          <!-- <span style="color: red;" *ngIf="employeeForm.get('firstName')?.errors?.['maxlength']">
            First Name should have at most 50 characters
          </span> -->
          <!-- Minlength Validation -->
          <!-- <span style="color: red;" *ngIf="employeeForm.get('firstName')?.errors?.['minlength']">
            First Name should have at least 3 characters
          </span> -->
        <!-- </small> -->
    </div>

    <!-- Last Name -->
    <div class="col-4 mb-3">
      <label for="lastName" class="form-label">Last Name<span style="color: red;">*</span></label>
     
      <input formControlName="lastName" id="lastName" class="form-control" placeholder="Enter Last Name" tabindex="-1"
        [ngClass]="{ 'is-invalid': employeeForm.get('lastName')?.touched && employeeForm.get('lastName')?.invalid }" maxlength="50" />
        <!-- <small *ngIf="employeeForm.get('lastName')?.invalid && 
        (employeeForm.get('lastName')?.touched || employeeForm.get('lastName')?.dirty)"> -->
          <!-- Maxlength Validation -->
          <!-- <span style="color: red;" *ngIf="employeeForm.get('lastName')?.errors?.['maxlength']">
            Last Name should have at most 50 characters
          </span> -->
          <!-- Minlength Validation -->
          <!-- <span style="color: red;" *ngIf="employeeForm.get('lastName')?.errors?.['minlength']">
            Last Name should have at least 3 characters
          </span>
        </small> -->
    </div>

    <!-- Gender -->
    <div class="col-4 mb-3">
      <label class="form-label">Gender<span style="color: red;">*</span></label>
      <div>
        <div class="form-check form-check-inline">
          <input type="radio" formControlName="gender" id="genderMale" value="Male" class="form-check-input" />
          <label for="genderMale" class="form-check-label">Male</label>
        </div>
        <div class="form-check form-check-inline">
          <input type="radio" formControlName="gender" id="genderFemale" value="Female" class="form-check-input" />
          <label for="genderFemale" class="form-check-label">Female</label>
        </div>
      </div>
      <!-- <small *ngIf="employeeForm.get('gender')?.touched && employeeForm.get('gender')?.invalid" class=" d-block"
        style="color: red;">
        Gender is required.
      </small> -->
    </div>
    <!-- Date of Birth -->
    <div class="col-4 mb-3 d-flex flex-column">
      <label for="dob" class="form-label">Date of Birth<span style="color: red;">*</span></label>
      <p-calendar formControlName="dob" [iconDisplay]="'input'" [showIcon]="true" inputId="icondisplay"
        placeholder="Select date of birth" dateFormat="dd/mm/yy" [maxDate]="minDate" [appendTo]="'body'"
        [ngClass]="{ 'is-invalid': employeeForm.get('dob')?.touched && employeeForm.get('dob')?.invalid }" />
      <!-- <small *ngIf="employeeForm.get('dob')?.touched && employeeForm.get('dob')?.invalid" style="color: red;">
            Date of birth is required.
          </small> -->
      <small *ngIf="employeeForm.get('dob')?.hasError('ageInvalid') && employeeForm.get('dob')?.touched"
        style="color: red;">
        You must be at least 18 years old.
      </small>
    </div>

    <!-- Email -->
    <div class="col-4 mb-3">
      <label for="email" class="form-label">Email<span style="color: red;">*</span></label> 
      <small *ngIf="serverError "  style="color: red;">
        {{serverError}}
      </small>
      <input type="email" formControlName="email" id="email" class="form-control" placeholder="Enter Email"
        (blur)="checkDuplicateEmail()" tabindex="-1"
        [ngClass]="{ 'is-invalid': employeeForm.get('email')?.touched && employeeForm.get('email')?.invalid}" />
      <!-- <small *ngIf="employeeForm.get('email')?.touched && employeeForm.get('email')?.invalid" style="color: red;">
           Enter valid email is required.
         </small> -->

    </div>

    <!-- Mobile -->
    <div class="col-4 mb-3">
      <label for="mobile" class="form-label">Mobile<span style="color: red;">*</span></label>
      <small *ngIf="numExistError " style="color: red;">
        {{numExistError}}
      </small>

      <input type="text" formControlName="mobile" id="mobile" class="form-control"
        [ngClass]="{ 'is-invalid': employeeForm.get('mobile')?.touched && employeeForm.get('mobile')?.invalid }"
        placeholder="Enter Mobile Number" maxlength="10" (blur)="checkDuplicateMobileNumber()"
        (keypress)="allowOnlyNumbers($event)" />
      <!-- <small *ngIf="employeeForm.get('mobile')?.touched && employeeForm.get('mobile')?.invalid" style="color: red;">
          Mobile number is required.
        </small> -->

    </div>
    <!--   Designation Name  -->
    <div class="col-4 mb-3 d-flex flex-column">
      <label for="designationId" class="form-label">
        Designation Name <span style="color: red;">*</span>
      </label>
      <p-dropdown id="designationId" formControlName="designationId" [options]="dropdownValue"
        optionLabel="designationName" optionValue="designationId" placeholder="Select a Designation" [showClear]="true"
        [ngClass]="{ 'is-invalid': employeeForm.get('designationId')?.touched && employeeForm.get('designationId')?.invalid }"></p-dropdown>
      <!-- <small
    *ngIf="employeeForm.get('designationId')?.touched && employeeForm.get('designationId')?.invalid"
    style="color: red;"
  >
    Designation Name is required.
  </small> -->
    </div>

    <!-- Date of Joining -->
    <div class="col-4 mb-3 d-flex flex-column">
      <label for="doj" class="form-label">Date of Joining<span style="color: red;">*</span></label>
      <p-calendar formControlName="doj" [iconDisplay]="'input'" [showIcon]="true" inputId="icondisplay"
        placeholder="Select date of joining" dateFormat="dd/mm/yy" [maxDate]="maxDate" [appendTo]="'body'"
        [ngClass]="{ 'is-invalid': employeeForm.get('doj')?.touched && employeeForm.get('doj')?.invalid }" />
      <!-- <small *ngIf="employeeForm.get('doj')?.touched && employeeForm.get('doj')?.invalid" style="color: red;">
          Date of joining is required.
        </small> -->
    </div>

    <!-- Date of Leave -->
    <!-- <div class="col-4 mb-3">
      <label for="dol" class="form-label">Date of Leaving</label>
      <p-calendar formControlName="dol" [iconDisplay]="'input'" [showIcon]="true" inputId="icondisplay"
        placeholder="Select date of leaving" dateFormat="dd/mm/yy" [minDate]=" this.employeeForm.get('doj')?.value"
        [appendTo]="'body'" />
      <small *ngIf="employeeForm.get('dol')?.hasError('dolBeforeDoj') && employeeForm.get('dol')?.touched"
        style="color: red;">
        Date of leave must be later than the date of joining.
      </small>
    </div> -->



    <!-- Salary -->
    <div class="col-4 mb-3">
      <label for="salary" class="form-label">Salary<span style="color: red;">*</span></label>
      <input type="text" formControlName="salary" id="salary" class="form-control" placeholder="Enter Salary"
        [ngClass]="{ 'is-invalid': employeeForm.get('salary')?.touched && employeeForm.get('salary')?.invalid }"
        (keypress)="allowOnlyNumbers($event)" maxlength="10" (input)="formatSalary($event)"/>
        <!-- <small
        *ngIf="employeeForm.get('salary')?.dirty && employeeForm.get('salary')?.hasError('maxlength')"
        style="color: red;">
        Salary should have at most 8 characters
      </small> -->
      <!-- <small *ngIf="employeeForm.get('salary')?.touched && employeeForm.get('salary')?.errors?.['required']" style="color: red;">
          Salary is required.
        </small> -->

      <!-- <small
        *ngIf="salaryControl?.touched && salaryControl?.hasError('pattern')"
        style="color: red;"
      >
        Salary must be at least 2 decimal places.
      </small> -->


    </div>
    <!-- Photo -->
    <div class="col-6 mb-3 d-flex">
      <!-- <label for="photoPath" class="form-label">Choose a file</label><br> -->
      <div *ngIf="!isEditing">
        <p-fileUpload name="photoPath" [multiple]="false" accept="image/*" [maxFileSize]="10485760"
          [showUploadButton]="false" [showCancelButton]="false" (onSelect)="onUpload($event)">
        </p-fileUpload>
      </div>
      
        <div *ngIf="imageSrc" class="image-container">
          <img [src]="imageSrc" alt="Selected Image" class="image-preview" />
          <!-- Cancel button -->
          <button 
            type="button" 
            *ngIf="!isEditing"
            class="btn btn-danger btn-sm cancel-btn" 
             (click)="removeSelectedFile() "
            title="Cancel Image">
            <i class="pi pi-times"></i>
          </button>
      </div>
    </div>

  </div>
  <div class="float-end">
    <button type="reset" class="btn btn-danger me-3" (click)="close()">Cancel</button>
    <button type="submit" class="btn btn-primary">Submit</button>
  </div>
</form>